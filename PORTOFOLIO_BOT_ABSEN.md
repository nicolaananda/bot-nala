# ğŸ“š Portfolio: Bot Absensi & Invoice Generator

## ğŸ¯ Overview

**Bot Absensi & Invoice Generator** adalah sistem otomatis berbasis WhatsApp yang dirancang untuk memudahkan pengelolaan absensi siswa dengan fitur pembuatan invoice otomatis. Sistem ini menggabungkan teknologi WhatsApp Bot (Baileys), MongoDB, dan Dashboard Web untuk memberikan solusi lengkap bagi lembaga pendidikan atau kursus dalam mencatat kehadiran dan menghasilkan invoice secara otomatis.

---

## âœ¨ Fitur Utama

### ğŸ¤– WhatsApp Bot Features

#### 1. **Pencatatan Absensi via Foto**
- Sistem menerima foto absensi dengan caption khusus
- Format: `absen [NamaSiswa] [Harga] [Tanggal] [Deskripsi]`
- Contoh: `absen Budi 150000 10/11/2025 Kelas Piano Dasar`
- Foto otomatis disimpan ke Cloudflare R2 (object storage) atau lokal
- Data tersimpan ke MongoDB dengan metadata lengkap

#### 2. **Invoice Generator Otomatis**
- **Auto-Generate**: Invoice otomatis dibuat ketika siswa memiliki 4 absen yang belum di-invoice
- **Manual Generate**: Command `invoice [NamaSiswa]` untuk membuat invoice manual
- Template invoice profesional dengan foto absensi (max 4 foto per invoice)
- Informasi lengkap: Nama siswa, tanggal invoice, total harga, detail setiap absen

#### 3. **Smart Tracking System**
- Tracking status invoice per absen (`isInvoiced`)
- Mencegah duplikasi invoice
- Historis lengkap absensi per siswa

### ğŸ“Š Dashboard Web Features

#### 1. **Statistik Dashboard**
- Total siswa terdaftar
- Total absensi keseluruhan
- Total pendapatan (revenue)
- Status invoice (sudah/belum di-invoice)
- Grafik pendapatan per bulan (6 bulan terakhir)
- Top 10 siswa berdasarkan jumlah absensi

#### 2. **Manajemen Data**
- Tampilan tabel absensi dengan foto
- Filter berdasarkan nama siswa
- Filter berdasarkan rentang tanggal
- Pagination untuk performa optimal
- Modal detail untuk melihat foto absensi dalam ukuran penuh

#### 3. **Data Export**
- Export data ke JSON
- Export data ke CSV
- Download invoice individual

#### 4. **Manajemen Siswa**
- Daftar semua siswa dengan statistik lengkap
- Total absensi per siswa
- Total pendapatan per siswa
- Status invoice per siswa (sudah/belum)
- View detail absensi per siswa

---

## ğŸ› ï¸ Technology Stack

### Backend
- **Node.js** - Runtime environment
- **Express.js** - Web framework untuk dashboard API
- **MongoDB** - Database NoSQL untuk menyimpan data absensi
- **Mongoose** - ODM untuk MongoDB

### WhatsApp Bot
- **Baileys** (@dappaoffc/baileys) - WhatsApp Web API library
- **Axios** - HTTP client untuk API calls
- **Moment.js** - Date/time manipulation

### Image Processing
- **Jimp** - Image manipulation library untuk generate invoice
- **Cloudflare R2** - Object storage untuk foto absensi
- **AWS SDK** (@aws-sdk/client-s3) - R2 S3-compatible API

### Frontend Dashboard
- **Vanilla JavaScript** - No framework, pure JS
- **CSS3** - Modern styling dengan Grid & Flexbox
- **Chart.js** - Grafik visualisasi data
- **Font Awesome** - Icon library

### Utilities
- **Chalk** - Terminal colors
- **File System** - File operations
- **Path** - Path manipulation

---

## ğŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WhatsApp Bot                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Baileys (WhatsApp Web API)                      â”‚  â”‚
â”‚  â”‚  - Receive messages                              â”‚  â”‚
â”‚  â”‚  - Process attendance commands                   â”‚  â”‚
â”‚  â”‚  - Generate invoices                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MongoDB       â”‚  â”‚  Cloudflare R2   â”‚
â”‚   - Attendance  â”‚  â”‚  - Photos        â”‚
â”‚   - Metadata    â”‚  â”‚  - Storage       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Dashboard Web Server                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Express.js API                        â”‚  â”‚
â”‚  â”‚  - REST API endpoints                  â”‚  â”‚
â”‚  â”‚  - Image processing                    â”‚  â”‚
â”‚  â”‚  - Data aggregation                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Frontend (HTML/CSS/JS)                â”‚  â”‚
â”‚  â”‚  - Statistics dashboard                â”‚  â”‚
â”‚  â”‚  - Attendance table                    â”‚  â”‚
â”‚  â”‚  - Charts & graphs                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Flow Diagram Bot

### 1. Flow Diagram - Proses Absensi (Input Foto)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USER MENGIRIM FOTO                       â”‚
â”‚         dengan caption: "absen Budi 150000 10/11/2025..."  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           BOT MENERIMA MESSAGE (Baileys)                     â”‚
â”‚  - Detect message type: imageMessage                         â”‚
â”‚  - Read caption body                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           VALIDASI CAPTION                                   â”‚
â”‚  âœ“ Apakah caption dimulai dengan "absen"?                   â”‚
â”‚  â†’ Jika TIDAK: Exit (skip processing)                       â”‚
â”‚  â†’ Jika YA: Lanjut ke parsing                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           PARSE CAPTION DATA                                 â”‚
â”‚  - Extract: NamaSiswa (captionParts[0])                     â”‚
â”‚  - Extract: Harga (captionParts[1])                         â”‚
â”‚  - Extract: Tanggal (captionParts[2]) - format DD/MM/YYYY  â”‚
â”‚  - Extract: Deskripsi (captionParts[3..])                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           VALIDASI DATA                                      â”‚
â”‚  âœ“ Apakah harga valid (number > 0)?                         â”‚
â”‚  âœ“ Apakah format tanggal valid (DD/MM/YYYY)?                â”‚
â”‚  âœ“ Apakah tanggal valid (tidak invalid date)?              â”‚
â”‚  â†’ Jika ERROR: Kirim error message ke user                 â”‚
â”‚  â†’ Jika VALID: Lanjut ke download foto                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           DOWNLOAD FOTO DARI WHATSAPP                        â”‚
â”‚  - Get image message (m.msg atau m.message.imageMessage)    â”‚
â”‚  - Download via downloadContentFromMessage()                â”‚
â”‚  - Retry mechanism (max 5 attempts dengan delay)              â”‚
â”‚  - Buffer photo data                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           SIMPAN FOTO                                        â”‚
â”‚  - Generate filename: nama_tanggal.jpg                      â”‚
â”‚  - Path: ./absen/nama_10-11-2025.jpg                        â”‚
â”‚  - Option 1: Upload ke R2 storage (Cloudflare)            â”‚
â”‚  - Option 2: Simpan ke local file system                    â”‚
â”‚  - Save photo buffer                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           SIMPAN DATA KE MONGODB                             â”‚
â”‚  - Create Attendance document                                â”‚
â”‚  {                                                           â”‚
â”‚    nama: "Budi",                                            â”‚
â”‚    harga: 150000,                                           â”‚
â”‚    tanggal: Date("2025-11-10"),                             â”‚
â”‚    deskripsi: "Kelas Piano Dasar",                          â”‚
â”‚    foto_path: "absen/budi_10-11-2025.jpg",                 â”‚
â”‚    isInvoiced: false,                                        â”‚
â”‚    createdAt: Date.now()                                    â”‚
â”‚  }                                                           â”‚
â”‚  - Save to MongoDB                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           CEK JUMLAH ABSEN BELUM DI-INVOICE                  â”‚
â”‚  - Query: Attendance.find({                                  â”‚
â”‚      nama: nama,                                            â”‚
â”‚      isInvoiced: false                                      â”‚
â”‚    })                                                        â”‚
â”‚  - Count: berapa absen yang belum di-invoice?              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                           â”‚
    Jumlah < 4                  Jumlah >= 4
         â”‚                           â”‚
         â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  KIRIM RESPONSE   â”‚   â”‚  GENERATE INVOICE OTOMATIS        â”‚
â”‚  "âœ… Data untuk   â”‚   â”‚  - Get 4 absen pertama            â”‚
â”‚   Budi pada       â”‚   â”‚  - Generate invoice dengan Jimp   â”‚
â”‚   10/11/2025      â”‚   â”‚  - Composite 4 foto (2x2 grid)   â”‚
â”‚   telah           â”‚   â”‚  - Add text (nama, tanggal, dll)  â”‚
â”‚   disimpan."      â”‚   â”‚  - Save invoice PNG              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  MARK ABSEN SEBAGAI     â”‚
                            â”‚  SUDAH DI-INVOICE       â”‚
                            â”‚  - Update 4 absen:     â”‚
                            â”‚    isInvoiced = true    â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                            â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  KIRIM INVOICE KE USER  â”‚
                            â”‚  - Send invoice image   â”‚
                            â”‚  - Caption: "ğŸ“„ Invoice â”‚
                            â”‚    untuk Budi telah     â”‚
                            â”‚    dibuat otomatis"     â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Flow Diagram - Proses Invoice Manual

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           USER MENGIRIM COMMAND                             â”‚
â”‚                   "invoice Budi"                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           BOT MENERIMA MESSAGE                              â”‚
â”‚  - Detect command: "invoice"                                â”‚
â”‚  - Extract parameter: "Budi" (nama siswa)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           QUERY ABSEN BELUM DI-INVOICE                      â”‚
â”‚  - Attendance.find({                                         â”‚
â”‚      nama: { $regex: /^Budi$/i },                          â”‚
â”‚      isInvoiced: false                                      â”‚
â”‚    })                                                        â”‚
â”‚  - Sort by: createdAt (ascending)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           CEK HASIL QUERY                                    â”‚
â”‚  â†’ Jika TIDAK ADA:                                          â”‚
â”‚    Kirim: "âš ï¸ Tidak ditemukan data absen..."               â”‚
â”‚  â†’ Jika ADA: Lanjut ke generate invoice                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           GENERATE INVOICE                                  â”‚
â”‚  - Load template: ./images/invoice.png                       â”‚
â”‚  - Loop absen (maksimal 4 foto pertama)                     â”‚
â”‚    â€¢ Download foto dari R2/lokal                            â”‚
â”‚    â€¢ Resize foto ke 320x320                                 â”‚
â”‚    â€¢ Composite ke invoice (grid 2x2)                        â”‚
â”‚    â€¢ Add text: tanggal, deskripsi, harga                    â”‚
â”‚  - Add nama siswa                                           â”‚
â”‚  - Add tanggal invoice                                      â”‚
â”‚  - Calculate & add total harga                              â”‚
â”‚  - Generate PNG buffer                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           SIMPAN INVOICE FILE                               â”‚
â”‚  - Filename: invoice_budi_DD-MM-YYYY.png                   â”‚
â”‚  - Path: ./invoice/invoice_budi_10-11-2025.png              â”‚
â”‚  - Save PNG buffer                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           MARK ABSEN SEBAGAI SUDAH DI-INVOICE               â”‚
â”‚  - Update all queried attendances:                          â”‚
â”‚    isInvoiced = true                                        â”‚
â”‚  - Update dalam database                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           KIRIM INVOICE KE USER                             â”‚
â”‚  - Send invoice image                                       â”‚
â”‚  - Caption: "ğŸ“„ Invoice untuk Budi (6 absen)               â”‚
â”‚             Total: Rp 900.000"                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Flow Diagram - Dashboard Web Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           USER MEMBUKA DASHBOARD                            â”‚
â”‚              http://localhost:3001                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           LOAD DASHBOARD HTML                               â”‚
â”‚  - Load index.html                                          â”‚
â”‚  - Load CSS & JavaScript                                    â”‚
â”‚  - Initialize Chart.js                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           FETCH DATA DARI API                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ GET /api/statistics                                 â”‚    â”‚
â”‚  â”‚ â†’ Total siswa, absensi, revenue, status invoice    â”‚    â”‚
â”‚  â”‚ â†’ Revenue per bulan (6 bulan)                      â”‚    â”‚
â”‚  â”‚ â†’ Top 10 siswa                                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ GET /api/attendances?page=1&limit=20               â”‚    â”‚
â”‚  â”‚ â†’ List absensi dengan pagination                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ GET /api/students                                  â”‚    â”‚
â”‚  â”‚ â†’ List semua siswa dengan statistik               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           RENDER DASHBOARD                                  â”‚
â”‚  - Display statistik cards (total siswa, absensi, dll)      â”‚
â”‚  - Render charts (revenue chart, top students chart)        â”‚
â”‚  - Render attendance table dengan foto thumbnails          â”‚
â”‚  - Render students list                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           USER INTERACTION                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ FILTER ABSENSI                                     â”‚    â”‚
â”‚  â”‚ â†’ Input nama / tanggal                             â”‚    â”‚
â”‚  â”‚ â†’ GET /api/attendances?nama=Budi&dateFrom=...     â”‚    â”‚
â”‚  â”‚ â†’ Update table                                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ GENERATE INVOICE                                   â”‚    â”‚
â”‚  â”‚ â†’ Pilih absen / siswa                              â”‚    â”‚
â”‚  â”‚ â†’ POST /api/invoice/generate                       â”‚    â”‚
â”‚  â”‚ â†’ Receive invoice (base64)                         â”‚    â”‚
â”‚  â”‚ â†’ Download invoice                                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ EXPORT DATA                                        â”‚    â”‚
â”‚  â”‚ â†’ GET /api/export/attendances?format=json         â”‚    â”‚
â”‚  â”‚ â†’ Download file                                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ DELETE ABSENSI                                     â”‚    â”‚
â”‚  â”‚ â†’ DELETE /api/attendances/:id                      â”‚    â”‚
â”‚  â”‚ â†’ Refresh table                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. Flow Diagram - Sistem Keseluruhan (End-to-End)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WHATSAPP BOT SYSTEM                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                       â”‚
        â–¼                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ INPUT ABSENSIâ”‚                      â”‚ MANUAL INVOICE   â”‚
â”‚ (Foto +      â”‚                      â”‚ (Command:        â”‚
â”‚ Caption)     â”‚                      â”‚ invoice [Nama])  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                       â”‚
       â–¼                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PROCESS & VALIDATE                            â”‚
â”‚  â€¢ Parse data                                              â”‚
â”‚  â€¢ Validate format                                         â”‚
â”‚  â€¢ Download foto                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              STORAGE LAYER                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  MongoDB     â”‚          â”‚  Cloudflare R2    â”‚          â”‚
â”‚  â”‚  - Metadata  â”‚          â”‚  - Photo Storage â”‚          â”‚
â”‚  â”‚  - Attendanceâ”‚          â”‚  - CDN URL       â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              INVOICE GENERATION                             â”‚
â”‚  â€¢ Check uninvoiced count                                  â”‚
â”‚  â€¢ Generate invoice (Jimp image processing)                â”‚
â”‚  â€¢ Mark as invoiced                                        â”‚
â”‚  â€¢ Send to WhatsApp                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DASHBOARD WEB SERVER                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Express.js API                                     â”‚   â”‚
â”‚  â”‚  â€¢ REST endpoints                                   â”‚   â”‚
â”‚  â”‚  â€¢ Data aggregation                                 â”‚   â”‚
â”‚  â”‚  â€¢ Image proxy (CORS)                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Frontend Dashboard                                 â”‚   â”‚
â”‚  â”‚  â€¢ Statistics view                                  â”‚   â”‚
â”‚  â”‚  â€¢ Attendance table                                â”‚   â”‚
â”‚  â”‚  â€¢ Charts & graphs                                 â”‚   â”‚
â”‚  â”‚  â€¢ Export functionality                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. Flow Diagram - Error Handling & Retry Mechanism

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ERROR SCENARIOS                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SCENARIO 1: Format Caption Salah                           â”‚
â”‚  â†’ Bot kirim: "âš ï¸ Format caption salah! Format: ..."      â”‚
â”‚  â†’ Process STOP                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SCENARIO 2: Foto Download Gagal                            â”‚
â”‚  â†’ Retry (attempt 1, 2, 3, 4, 5)                           â”‚
â”‚  â†’ Delay: 2s, 4s, 6s, 8s, 10s                             â”‚
â”‚  â†’ Jika semua retry gagal:                                 â”‚
â”‚    Bot kirim: "âš ï¸ Gagal mendownload foto setelah..."      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SCENARIO 3: MongoDB Connection Error                        â”‚
â”‚  â†’ Bot log error ke console                                â”‚
â”‚  â†’ Bot kirim: "âš ï¸ Terjadi kesalahan: [error message]"     â”‚
â”‚  â†’ Process STOP                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SCENARIO 4: R2 Upload Failed                               â”‚
â”‚  â†’ Fallback ke local file system                            â”‚
â”‚  â†’ Save foto ke ./absen/                                   â”‚
â”‚  â†’ Continue process                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SCENARIO 5: Invoice Generation Error                       â”‚
â”‚  â†’ Bot log error ke console                                â”‚
â”‚  â†’ Bot kirim: "âš ï¸ Gagal membuat invoice: [error]"         â”‚
â”‚  â†’ Data absensi tetap tersimpan                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Fitur Detail

### 1. Sistem Absensi

#### Cara Penggunaan
```
Kirim foto dengan caption:
absen [NamaSiswa] [Harga] [Tanggal] [Deskripsi]

Contoh:
absen Budi 150000 10/11/2025 Kelas Piano Dasar
```

#### Proses yang Terjadi
1. Bot menerima foto dan caption
2. Validasi format caption
3. Parse data: nama, harga, tanggal, deskripsi
4. Download foto dari WhatsApp
5. Simpan foto ke R2 storage atau lokal
6. Simpan metadata ke MongoDB
7. Cek apakah siswa sudah memiliki 4 absen belum di-invoice
8. Jika ya, otomatis generate invoice dan kirim ke WhatsApp

#### Data yang Disimpan
```javascript
{
  nama: "Budi",
  harga: 150000,
  tanggal: Date("2025-11-10"),
  deskripsi: "Kelas Piano Dasar",
  foto_path: "absen/budi_10-11-2025.jpg",
  isInvoiced: false,
  createdAt: Date
}
```

### 2. Invoice Generator

#### Fitur Invoice
- Template invoice profesional dengan desain custom
- Maksimal 4 foto absensi per invoice (grid 2x2)
- Informasi lengkap setiap absen:
  - Foto absensi
  - Tanggal absen
  - Deskripsi kelas
  - Harga per absen
- Total harga keseluruhan
- Nama siswa dan tanggal invoice

#### Auto-Generate Invoice
- Trigger otomatis saat siswa mencapai 4 absen belum di-invoice
- Mark 4 absen tersebut sebagai sudah di-invoice
- Kirim invoice langsung ke WhatsApp chat

#### Manual Invoice
```
Command: invoice [NamaSiswa]
Contoh: invoice Budi
```
- Generate invoice dari semua absen yang belum di-invoice
- Tidak terbatas 4 absen (semua absen dimasukkan)

### 3. Dashboard Web

#### Halaman Utama
- **Statistik Cards**: Quick view total siswa, absensi, revenue, status invoice
- **Charts**: 
  - Revenue per bulan (6 bulan terakhir)
  - Top 10 siswa (berdasarkan jumlah absensi)
- **Recent Activity**: Absensi terbaru

#### Daftar Absensi
- Tabel dengan kolom:
  - Foto absensi (thumbnail)
  - Nama siswa
  - Tanggal absen
  - Deskripsi
  - Harga
  - Status invoice
  - Actions (view, delete, generate invoice)

- Filter options:
  - By nama siswa
  - By date range (dari - sampai)

- Pagination:
  - Default 20 items per page
  - Configurable limit

#### Daftar Siswa
- Statistik per siswa:
  - Total absensi
  - Total pendapatan
  - Jumlah sudah di-invoice
  - Jumlah belum di-invoice
  - Tanggal absen pertama
  - Tanggal absen terakhir

- Action: View detail absensi per siswa

#### Generate Invoice
- Pilih siswa atau pilih absen spesifik
- Generate invoice langsung dari dashboard
- Preview invoice sebelum download
- Download invoice sebagai PNG

---

## ğŸš€ Installation & Setup

### Prerequisites
- Node.js (v14+)
- MongoDB database (local atau cloud)
- Cloudflare R2 account (optional, bisa menggunakan lokal storage)
- WhatsApp account untuk bot

### Install Dependencies

```bash
npm install
```

### Configuration

Buat file `settings.js` dengan konfigurasi:

```javascript
global.mongodblink = 'mongodb://localhost:27017/bot-absensi';
// atau
global.mongodblink = 'mongodb+srv://user:pass@cluster.mongodb.net/dbname';

// R2 Configuration (optional)
global.R2_ACCOUNT_ID = 'your-account-id';
global.R2_ACCESS_KEY_ID = 'your-access-key';
global.R2_SECRET_ACCESS_KEY = 'your-secret-key';
global.R2_BUCKET_NAME = 'your-bucket-name';
global.R2_ENDPOINT = 'https://your-account-id.r2.cloudflarestorage.com';
global.R2_PUBLIC_URL = 'https://cdn-absen.nicola.id'; // Your CDN URL
```

### Run Bot

```bash
# Run bot only
npm start

# Run dashboard only
npm run dashboard

# Run both
node index.js && node dashboard-server.js
```

### Access Dashboard

```
http://localhost:3001
```

Default port: `3001` (configurable via `DASHBOARD_PORT` env variable)

---

## ğŸ“– Usage Examples

### 1. Mencatat Absensi

```
User mengirim foto dengan caption:
"absen Budi 150000 10/11/2025 Kelas Piano Dasar"

Bot response:
"âœ… Data untuk Budi pada 10/11/2025 telah disimpan."
```

### 2. Auto Invoice (setelah 4 absen)

```
Setelah absen ke-4 untuk Budi, bot otomatis:
1. Generate invoice dengan 4 foto absensi
2. Mark 4 absen sebagai sudah di-invoice
3. Kirim invoice ke chat

Response:
"ğŸ“„ Invoice untuk Budi telah dibuat secara otomatis."
+ [Invoice Image]
```

### 3. Manual Invoice

```
User mengirim command:
"invoice Budi"

Bot response:
"ğŸ“„ Invoice untuk Budi (6 absen)
Total: Rp 900.000"
+ [Invoice Image]
```

### 4. Dashboard Usage

1. **View Statistics**: Dashboard utama menampilkan statistik real-time
2. **Filter Absensi**: Gunakan filter nama atau tanggal untuk mencari absensi spesifik
3. **View Student Details**: Klik nama siswa untuk melihat semua absensi mereka
4. **Generate Invoice**: Pilih absen dan klik "Generate Invoice"
5. **Export Data**: Export semua data ke JSON atau CSV

---

## ğŸ’¡ Technical Highlights

### 1. Image Storage Strategy
- **Primary**: Cloudflare R2 (object storage) dengan CDN
- **Fallback**: Local file system
- **Smart Loading**: Auto-detect storage location (R2, CDN, atau lokal)
- **CORS Handling**: Proxy endpoint untuk bypass CORS restrictions

### 2. Invoice Generation Algorithm
- Custom image processing dengan Jimp
- Template-based invoice design
- Smart text positioning dengan custom fonts
- Color customization (text color, background)
- Grid layout untuk multiple photos (2x2)

### 3. Database Schema Design
```javascript
{
  nama: String (required),
  harga: Number (required),
  tanggal: Date (required),
  deskripsi: String (required),
  foto_path: String (required),
  isInvoiced: Boolean (default: false),
  createdAt: Date (default: now)
}
```

### 4. API Architecture
- RESTful API design
- Pagination support
- Filter & search capabilities
- Error handling dengan proper status codes
- Response format standardization

### 5. Performance Optimizations
- Image lazy loading di dashboard
- Pagination untuk large datasets
- Base64 encoding untuk small images
- CDN caching untuk R2 images
- MongoDB indexes untuk fast queries

---

## ğŸ“¸ Features Showcase

### WhatsApp Bot Interface
- âœ… Receive photo dengan caption
- âœ… Validate & parse attendance data
- âœ… Auto-save to database
- âœ… Auto-generate invoice
- âœ… Send invoice back to chat

### Dashboard Interface
- âœ… Real-time statistics
- âœ… Interactive charts (Chart.js)
- âœ… Responsive design (mobile-friendly)
- âœ… Modern UI/UX
- âœ… Fast data loading dengan pagination
- âœ… Export functionality

### Invoice Features
- âœ… Professional design
- âœ… Photo grid layout (2x2)
- âœ… Complete information
- âœ… Customizable template
- âœ… PNG format output

---

## ğŸ”§ Advanced Features

### 1. R2 Integration
- Seamless upload/download dari Cloudflare R2
- Public URL generation untuk CDN
- Automatic fallback ke local storage
- Image proxy untuk CORS bypass

### 2. Retry Mechanism
- Auto-retry untuk foto download (max 5 attempts)
- Error handling dengan user-friendly messages
- Logging untuk debugging

### 3. Date/Time Handling
- Moment.js dengan timezone support (Asia/Jakarta)
- Format validation (DD/MM/YYYY)
- Date parsing & formatting

### 4. Data Export
- JSON export dengan full metadata
- CSV export untuk spreadsheet compatibility
- Timestamped filenames

---

## ğŸ“Š Database Statistics

Sistem menyediakan agregasi data untuk:
- Total revenue calculation
- Revenue per month
- Top students by attendance count
- Invoice status tracking
- Student statistics

---

## ğŸ¨ UI/UX Highlights

- **Modern Design**: Clean, professional interface
- **Responsive**: Works on desktop, tablet, mobile
- **Fast Loading**: Optimized API calls & pagination
- **Interactive**: Real-time updates, smooth animations
- **User-Friendly**: Intuitive navigation, clear labels

---

## ğŸ”’ Security & Best Practices

- Input validation untuk semua user input
- SQL injection prevention (MongoDB parameterized queries)
- Error handling dengan proper logging
- File system security checks
- Environment variable untuk sensitive data

---

## ğŸ“ˆ Scalability

- **Database**: MongoDB scalable untuk large datasets
- **Storage**: R2 object storage untuk unlimited photos
- **API**: RESTful design untuk easy integration
- **Frontend**: Client-side rendering untuk better performance

---

## ğŸš€ Future Enhancements

Potential improvements:
- [ ] Multi-tenant support (multiple courses/institutions)
- [ ] Email invoice delivery
- [ ] Payment tracking integration
- [ ] SMS notifications
- [ ] Mobile app (React Native)
- [ ] Advanced analytics & reports
- [ ] Batch invoice generation
- [ ] Template customization UI

---

## ğŸ“ Project Structure

```
bot-nala/
â”œâ”€â”€ absen/                    # Photo storage (local)
â”œâ”€â”€ dashboard/                # Dashboard web files
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â”œâ”€â”€ index.html       # Dashboard UI
â”‚   â”‚   â”œâ”€â”€ css/             # Styling
â”‚   â”‚   â””â”€â”€ js/              # Frontend logic
â”œâ”€â”€ database/                 # JSON database files
â”œâ”€â”€ invoice/                  # Generated invoices
â”œâ”€â”€ images/                   # Invoice template
â”œâ”€â”€ lib/                      # Utility libraries
â”‚   â”œâ”€â”€ r2.js                # R2 storage functions
â”‚   â””â”€â”€ exif.js              # Image processing
â”œâ”€â”€ index.js                  # Bot entry point
â”œâ”€â”€ main.js                   # Bot main logic
â”œâ”€â”€ arap.js                   # Bot handlers
â”œâ”€â”€ dashboard-server.js       # Dashboard API server
â”œâ”€â”€ settings.js              # Configuration
â”œâ”€â”€ package.json             # Dependencies
â””â”€â”€ PORTOFOLIO_BOT_ABSEN.md  # This file
```

---

## ğŸ“ Technical Details

### Dependencies
- **@dappaoffc/baileys**: WhatsApp Web API
- **express**: Web framework
- **mongoose**: MongoDB ODM
- **jimp**: Image processing
- **moment-timezone**: Date/time handling
- **@aws-sdk/client-s3**: R2 storage
- **axios**: HTTP client
- **chalk**: Terminal colors

### API Endpoints

#### Dashboard API
- `GET /api/attendances` - Get all attendances (with pagination & filters)
- `GET /api/statistics` - Get dashboard statistics
- `GET /api/students` - Get all students with stats
- `GET /api/attendances/student/:nama` - Get attendances by student
- `POST /api/invoice/generate` - Generate invoice
- `GET /api/invoice/:filename` - Get invoice file
- `DELETE /api/attendances/:id` - Delete attendance
- `GET /api/export/attendances` - Export data (JSON/CSV)
- `GET /api/image/:imagePath` - Image proxy (CORS bypass)

---

## ğŸ† Project Achievements

âœ… **Fully Automated**: From attendance input to invoice generation  
âœ… **Real-time Dashboard**: Live statistics and data visualization  
âœ… **Scalable Architecture**: Ready for production use  
âœ… **User-Friendly**: Simple commands, intuitive interface  
âœ… **Professional Output**: High-quality invoice generation  
âœ… **Cloud-Ready**: R2 integration for unlimited storage  
âœ… **Performance Optimized**: Fast loading, efficient queries  

---

## ğŸ“„ License

MIT License - Free to use and modify

---

## ğŸ‘¨â€ğŸ’» Developer Notes

Bot ini dibuat dengan:
- Node.js ecosystem
- Modern JavaScript (ES6+)
- Best practices untuk WhatsApp bots
- Clean code architecture
- Comprehensive error handling
- Production-ready code

---

**Portfolio created**: 2025  
**Project Type**: WhatsApp Bot + Web Dashboard  
**Status**: Production Ready âœ…

